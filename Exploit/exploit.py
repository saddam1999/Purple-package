#!/usr/bin/python
# -*- coding: utf-8 -*-
import os
import sys
import dfu
import checkm8
import subprocess
import time
start = time.time()
def rmsig():
	cmd = 'python2.7 rmsigchks.py'
	ras = os.popen(cmd).read()
	print(ras)
	os.chdir("../..")
def runexploit():
	
	try:
		device = dfu.acquire_device()
		serial_number = device.serial_number
		dfu.release_device(device)
		if 'CPID:8947' in serial_number:
			runexploit = checkm8.exploit()
		elif 'CPID:8950' in serial_number:
			runexploit = checkm8.exploit() 
		elif 'CPID:8955' in serial_number:
			runexploit = checkm8.exploit()
		elif 'CPID:8960' in serial_number:
			runexploit = checkm8.exploit()
		elif 'CPID:8002' in serial_number:
			runexploit = checkm8.exploit() 
		elif 'CPID:8004' in serial_number:
			runexploit = checkm8.exploit() 
		elif 'CPID:8010' in serial_number:
			runexploit = checkm8.exploit() 
		elif 'CPID:8011' in serial_number:
			runexploit = checkm8.exploit() 
		elif 'CPID:8015' in serial_number:
			runexploit = checkm8.exploit() 
		else:
			print 'Device is not supported.'
			sys.exit(1)
		#print('(%0.2f seconds)' % (time.time() - start))
	except AttributeError:
		print ""
if __name__ == "__main__":
	pwndfumode()
